#textdomain wesnoth-AD

[scenario]
    id=05_The_Discipline
    name= _ "The Discipline"
    map_data="{~add-ons/Ashievieres_Dogs/maps/05_The_Discipline.map}"

    [event]
    name=new_turn 
    first_time_only=no

        {LIGHT_EFFECT "*^Ecf"}
    [/event] 

    [event]
        name=prestart 

        {PLACE_IMAGE scenery/well.png 24 14}
        {PLACE_IMAGE scenery/tent-shop-weapons.png 22 18}
        {PLACE_IMAGE items/straw-bale1.png 17 15}
        {PLACE_IMAGE items/straw-bale2.png 18 13}
    [/event]

    {BIRD_SOUND 36 2}
    {RIVER_SLOW 13 6 3 6}
    {RIVER_SLOW 6 7 3 6}

    {TURNS 26 24 23}
    next_scenario=06_The_Art_of_War
    victory_when_enemies_defeated=no
    carryover_percentage=40
    carryover_add=yes
    current_time=5

    {DEFAULT_SCHEDULE}

    {SCENARIO_MUSIC "knolls.ogg"}
    {EXTRA_SCENARIO_MUSIC "the_city_falls.ogg"}
    {EXTRA_SCENARIO_MUSIC suspence.ogg}
    {EXTRA_SCENARIO_MUSIC the_king_is_dead.ogg}

    [story]
        [part]
            story=_"Isolde's surprise raid ruined the rebels' plans in the north. After destroying warehouses and leaders, the orcs also set fire to the forest. The Elven army, with which the rebels wanted to retake Soradoc, was thrown into the fire."
            {AD_BIGMAP}
            {JOURNEY_04_OLD}
        [/part]
        [part]
            story=_"Asheviere's dangerous bet on the orcs had worked. In no time at all, the Queen had a brutal, capable army at her fingertips, leveling the chances in the armed struggle. This made the sacrifice of the innocent justifiable in the Queen's eyes."
            {AD_BIGMAP}
            {JOURNEY_04_OLD}
        [/part]
        [part]
            story=_"At Weldyn, the rebels were met by an orc horde comparable to the one that had plundered Wesnoth months earlier. By fighting them, the rebels risked losing their entire army, for orcs give no mercy and know no fatigue in pursuit. In shame, the rebel generals led the soldiers back to Dan-Tonk."
            {AD_BIGMAP}
            {JOURNEY_04_OLD}
        [/part]
        [part]
            story=_"The scales were tipping in the Queen's favour. The rebels negotiated with Aethenwood and Elensefar, hoping to draw their neighbours into the war and hold out until their armies arrived. However, Asheviere learnt from the mistakes of others and immediately moved her armies on Dan-Tonk. According to her plan, the main part of the royal army was to approach the city from the south, while another unit, consisting mostly of orcs, was to capture Tath and strike from the north."
            {AD_BIGMAP}
            {JOURNEY_04_OLD}
        [/part]
        [part]
            story=_"Bazur's gang joined the northern part of the royal pincers. Leaving Glyn's Forest, the orcs moved towards Tath."
            {AD_BIGMAP}
            {JOURNEY_04_OLD}
        [/part]
    [/story]

    {AD_TRACK {JOURNEY_05_NEW} }

    [label]
        x,y=21,16
        text=_ "Tath"
        immutable=yes
    [/label]

    {STARTING_VILLAGES 1 4}

    [event]
        name=prestart 

        [capture_village]
            side=4
            y=6-31
        [/capture_village]
    [/event]

    {STARTING_VILLAGES 2 5}
    {STARTING_VILLAGES 3 5}

    [side]
        side=1
        controller=human
        gold=135
        {INCOME 5 3 1}
        fog=no
        shroud=no
        share_vision=all
        {BAZUR_ARC_I}
        #recruit=Orcish Grunt,Orcish Archer,Wolf Rider,Goblin Spearman,Orcish Assassin
        color=white
        team_name=bazur
        user_team_name= _ "Asheviere's Forces"
        save_id=bazur
        {FLAG_VARIANT ragged}
    [/side]

    [side]
        side=2
        controller=ai
        {GOLD 125 250 375}
        {INCOME 3 6 9}
        fog=no
        shroud=no
        share_vision=all
        type=Orcish Warlord
        id=Warlord_South
        recruit=Orcish Grunt,Troll Whelp,Troll,Troll Rocklobber,Troll Warrior,Orcish Archer
        team_name=bazur,evil_orcs
        user_team_name= _ "Asheviere's Forces"
        color=blue
        {FLAG_VARIANT ragged}
        [ai]
            {NO_SCOUTS}
            recruitment_pattern=fighter,fighter,fighter,archer

            [goal]
                name=target_location 
                [criteria]
                    x,y=24,16 
                [/criteria]
                value={ON_DIFFICULTY "1.25" 2 3}
            [/goal]
        [/ai]
    [/side]

    {LIMIT_CONTEMPORANEOUS_RECRUITS 2 "Orcish Grunt" {ON_DIFFICULTY 4 3 2}}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 2 "Orcish Archer" {ON_DIFFICULTY 4 3 2}}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 2 "Troll Warrior" {ON_DIFFICULTY 1 2 3}}

    [side]
        side=3
        controller=ai
        {GOLD 125 250 375}
        {INCOME 3 6 9}
        fog=no
        shroud=no
        share_vision=all
        type=Orcish Warlord
        id=Warlord_West
        recruit=Orcish Archer,Orcish Crossbowman,Goblin Pillager,Goblin Knight,Wolf Rider,Orcish Grunt
        color=green
        team_name=bazur,evil_orcs
        user_team_name= _ "Asheviere's Forces"
        {FLAG_VARIANT ragged}
        [ai]
            {NO_SCOUTS}
            recruitment_pattern=archer,archer,scout,fighter

            [goal]
                name=target_location 
                [criteria]
                    x,y=24,16 
                [/criteria]
                value={ON_DIFFICULTY "1.25" 2 3}
            [/goal]
        [/ai]
    [/side]

    {LIMIT_CONTEMPORANEOUS_RECRUITS 3 "Goblin Pillager" {ON_DIFFICULTY 1 2 2}}

    [side]
        side=4
        controller=ai
        {GOLD 150 200 250}
        {INCOME 4 8 12}
        fog=no
        shroud=no
        share_vision=all
        type=AD_Sir_Gwido
        id=Sir_Gwido
        name=_ "Sir Gwido"
        [modifications]
            {TRAIT_HEROIC}
        [/modifications]
        recruit=Bowman,Spearman,Longbowman,Javelineer,Peasant,Woodsman
        color=purple
        team_name=rebels
        user_team_name= _ "Rebel Forces"

        {FLAG_VARIANT long}

        [ai]
            recruitment_pattern=archer,archer,archer,fighter,mixed fighter
            [avoid]
                [not]
                    x,y,radius=21,16,5
                [/not]
            [/avoid]

            [goal]
                name=protect_location
                [criteria]
                    x,y,radius=24,16,4
                [/criteria]
                value=100
            [/goal]
        [/ai]
    [/side]

    [side]
        side=5
        controller=ai
        fog=no
        shroud=no
        share_vision=all
        color=orange
        team_name=elves
        hidden=yes
        user_team_name= _ "Elvish Forces"
        {FLAG_VARIANT wood-elvish}
    [/side]

    [side]
        side=6
        controller=ai
        fog=no
        shroud=no
        share_vision=all
        no_leader=yes
        color=black
        team_name=elves,evil_orcs,bazur,rebels
        hidden=yes
        user_team_name= _ "Neutrals"
        {FLAG_VARIANT ragged}
        [ai]
            allow_ally_villages=yes
            [avoid]
                x=31
                y=28
                radius=6
            [/avoid]
            [avoid]
                x=4
                y=17
                radius=6
            [/avoid]
        [/ai]
    [/side]

    {PEASANT_SIDE 7}
    [+side]
        [ai]
            [avoid]
                x=31
                y=28
                radius=6
            [/avoid]
            [avoid]
                x=4
                y=17
                radius=6
            [/avoid]
        [/ai]
    [/side]

    {AD_CAPTURE_EVENT 7}
    
    {AD_RECRUIT_EVENT}
    {AD_LOYALS_EVENTS}

    {AD_MARAUDERS}
    {HERODEATH_ACT_I}

    [event]
    name=prestart

        [recall]
            id=Isolde
            placement=leader
        [/recall]

        [recall]
            id=Aryn
            placement=leader
        [/recall]

        {NAMED_UNIT 7 Peasant 32 13 () (Cowardly Peasant) (role=coward
        [modifications]
            {TRAIT_SCARED}
        [/modifications])}
        {NAMED_UNIT 7 Peasant 32 11 () (Cowardly Peasant) (role=coward
        [modifications]
            {TRAIT_SCARED}
        [/modifications])}
        {NAMED_UNIT 7 Peasant 24 10 () (Cowardly Peasant) (role=coward
        [modifications]
            {TRAIT_SCARED}
        [/modifications])}
        {NAMED_UNIT 7 Peasant 27 12 () (Cowardly Peasant) (role=coward
        [modifications]
            {TRAIT_SCARED}
        [/modifications])}
        {NAMED_UNIT 7 Peasant 23 9 () (Cowardly Peasant) (role=coward
        [modifications]
            {TRAIT_SCARED}
        [/modifications])}
        {NAMED_UNIT 7 Peasant 17 10 () (Cowardly Peasant) (role=coward
        [modifications]
            {TRAIT_SCARED}
        [/modifications])}

        {GENERIC_UNIT 4 Bowman 16 18}{GUARDIAN}
        {GENERIC_UNIT 4 Longbowman 19 20}{GUARDIAN}
        {GENERIC_UNIT 4 Bowman 21 21}{GUARDIAN}
        {GENERIC_UNIT 4 Javelineer 24 19}{GUARDIAN}
        {GENERIC_UNIT 4 Spearman 16 15}{GUARDIAN}
        {GENERIC_UNIT 4 Bowman 26 18}{GUARDIAN}
        {GENERIC_UNIT 4 Spearman 26 14}{GUARDIAN}
        {GENERIC_UNIT 4 Bowman 24 12}{GUARDIAN}
        {GENERIC_UNIT 4 Longbowman 21 11}{GUARDIAN}
        {GENERIC_UNIT 4 Bowman 18 12}{GUARDIAN}
        {GENERIC_UNIT 4 Longbowman 16 13}{GUARDIAN}

    #    [micro_ai]
    #        side=4
    #        ai_type=zone_guardian
    #        action=add
    #
    #        [filter]
    #            side=4
    #            canrecruit=no
    #        [/filter]
    #        [filter_location]
    #            x,y,radius=21,16,4
    #            terrain=C*,K*,V*
    #        [/filter_location]
    #    [/micro_ai]

        [micro_ai]
            side=2
            ai_type=simple_attack
            action=add

            [filter]
                id=Big_Kruuk
            [/filter]
            [filter_second]
                level=0
            [/filter_second]
        [/micro_ai]

        [micro_ai]
            side=4
            ai_type=simple_attack
            action=add

            [filter]
                id=Sir_Gwido
            [/filter]
            [filter_second]
                level=3
            [/filter_second]
        [/micro_ai]

        [micro_ai]
            side=7
            ai_type=goto
            action=add

            [filter]
                role=coward
            [/filter]
            [filter_location]
                x,y=38,1
                radius=1
            [/filter_location]
            ca_score=600000
        [/micro_ai]

        {NAMED_UNIT 7 Peasant 26 22 () (Brave Peasant) (role=brave)}
        {NAMED_UNIT 7 Peasant 28 21 () (Brave Peasant) (role=brave)}
        {NAMED_UNIT 7 Peasant 23 24 () (Brave Peasant) (role=brave)}
        {NAMED_UNIT 7 Peasant 27 21 () (Brave Peasant) (role=brave)}
        {NAMED_UNIT 7 Peasant 32 19 () (Brave Peasant) (role=brave)}

        {NAMED_UNIT 7 Peasant 12 17 () (Brave Peasant) (role=brave)}
        {NAMED_UNIT 7 Peasant 11 14 () (Brave Peasant) (role=brave)}
        {NAMED_UNIT 7 Peasant 7 14 () (Brave Peasant) (role=brave)}
        {NAMED_UNIT 7 Peasant 26 21 () (Brave Peasant) (role=brave)}

        {NAMED_UNIT 2 (Troll Warrior) 27 22 (Big_Kruuk) (Big Kruuk) (
        hitpoints=100
        max_hitpoints=100
        {TRAIT_STRONG})}

        {GENERIC_UNIT 3 (Orcish Grunt) 8 18}
        {GENERIC_UNIT 3 (Orcish Archer) 5 15}

        [unit_overlay]
            role=coward
            image="misc/fear.png"
            object_id=fear
        [/unit_overlay]

        {FORCE_CHANCE_TO_HIT id=Big_Kruuk level=0 100 ()}
        {FORCE_CHANCE_TO_HIT id=Sir_Gwido level=3 90 ()}

        #neutrals: 

        {UNIT 6 "Direwolf Rider" 8 2 (
        facing=sw
        id=Punk 
        name=_ "Punk"
        {IS_HERO})}

        {GENERIC_UNIT 6 "Goblin Pillager" 8 3}
        [+unit]
            facing=nw
        [/unit]
        {GENERIC_UNIT 6 "Wolf Rider" 6 3}
        [+unit]
            facing=ne
        [/unit]
        {GENERIC_UNIT 6 "Wolf Rider" 6 2}
        [+unit]
            facing=ne
        [/unit]
        {GENERIC_UNIT 6 "Goblin Knight" 7 2}
        [+unit]
            facing=s
        [/unit]

        {MODIFY_AI_ADD_ASPECT 6 avoid (
        [facet]
            id="stay_in_camp"
            [value]
                [not]
                    x,y,radius=7,3,1
                [/not]
            [/value]
        [/facet]
        )}
    [/event]

    [event]
    name=start 

        [message]
            speaker=Isolde
            message=_ "Looks like the orcs have just begun their siege! We're just in time!"
        [/message] 

        [message]
            speaker=Bazur
            message=_ "Bah, what allies we have here - troll face and fox tail!"
        [/message] 

        [message]
            speaker=Isolde
            message=_ "What are you talking about?"
        [/message] 

        [scroll_to_unit]
            id=Warlord_South 
        [/scroll_to_unit]

        [message]
            speaker=Bazur
            scroll=no
            message=_ "See the orcs under the blue banner? Those are the Stoneskins, or troll faces. They have become so friendly with the trolls that they have become like trolls themselves - stupid and stinky! The trolls do all the work, and the chiefs have little control over them."
        [/message] 

        [message]
            scroll=no
            speaker=Isolde
            message=_ "Got it. And what's a fox tail?"
        [/message] 

        [scroll_to_unit]
            id=Warlord_West 
        [/scroll_to_unit]

        [message]
            speaker=Bazur
            scroll=no
            message=_ "And the Foxtails are the other orcs, under the green banner. They like fire, that's why they're called Fox Tails, which is fire in our way. They burn everything, but they don't know how to fight well. They are as useless as troll faces, so they are not respected."
        [/message] 

        [message]
            speaker=Isolde
            message=_ "That's how it is. And you're from an respected clan?"
        [/message] 

        [message]
            speaker=Bazur
            message=_ "Of course! I am Bazur White Fang, my clan is the oldest, every orc knows it. You should be proud that I fight for you!"
        [/message] 

        [message]
            speaker=Isolde
            message=_ "I'll be proud when we take the Tath. Go ahead, prove you're better than them!"
        [/message]

        [message]
            speaker=Bazur
            message=_ "You'll see!"
        [/message] 

        [message]
            speaker=Sir_Gwido 
            message=_ "We're surrounded, but don't despair, friends! I've sent Lars to the Glyn's Forest, he'll be back soon with reinforcements!"
        [/message]

        [scroll_to_unit]
            id=Bazur 
        [/scroll_to_unit]

        [objectives]
            silent=no
                [objective]
                    [show_if]
                        [have_unit]
                            id=Sir_Gwido
                        [/have_unit]
                    [/show_if]
                    caption=_ "Your first task:"
                    description= _ "Defeat Sir Gwido"
                    condition=win
                [/objective]
                [objective]
                    [show_if]
                        [variable]
                            name=leaderkill
                            numerical_equals=1
                        [/variable]
                    [/show_if]
                    caption=_ "New task:"
                    description= _ "Kill all orcs within a 4 hex radius of Tath's citadel"
                    condition=win
                [/objective]
                [objective]
                    description= _ "Death of Bazur"
                    condition=lose
                [/objective]
                [objective]
                    description= _ "Deth of Isolde"
                    condition=lose
                [/objective]
                {TURNS_RUN_OUT}
                [gold_carryover]
                    bonus=yes
                    carryover_percentage=40
                    carryover_add=yes
                [/gold_carryover]
        [/objectives]   
    [/event]

    [event]
        name=last breath 

        [filter]
            id=Sir_Gwido 
        [/filter]

        [message]
            speaker=Sir_Gwido 
            message=_ "Apparently, I'm destined to fall in this fight.... Lady Aviel, I dedicate my last words to you, may you be safe!"
        [/message]
    [/event]

    [event]
    name=die

        [filter]
            id=Sir_Gwido
        [/filter]

        {VARIABLE leaderkill 1}
        {INCIDENTAL_MUSIC northerners.ogg}

        [message]
            side=4
            canrecruit=no
            message=_ "We surrender!"
        [/message]

        [message]
            speaker=Isolde
            message=_ "The city is ours, stop the slaughter."
        [/message] 

        [store_unit]
            [filter]
                side=2
                race=troll 
            [/filter]
            variable=troll 
            kill=no 
        [/store_unit]

        [message]
            find_in=troll
            message=_ "$troll.name doesn't want to stand, he wants to keep squashing crawlers!"
        [/message] 

        {CLEAR_VARIABLE troll}

        [message]
            speaker=Warlord_South
            message=_ "Seriously, we have orders to deal with the rebels, we're just getting started, why stop?"
        [/message] 

        [message]
            speaker=Isolde
            message=_ "We all have the same order - to bring the Tath back under the banner of the Crown, not to destroy it."
        [/message] 

        [message]
            speaker=Warlord_West
            message=_ "You are not my command! You will not deprive my warriors of the spoils of war!"
        [/message] 

        [message]
            speaker=Bazur 
            message=_ "What's wrong with punishing and plundering the rebels? They're bad!"
        [/message]

        [message]
            speaker=Isolde
            message=_ "And you too?! If you disobey orders, the queen will deprive you of all your rewards!"
        [/message] 

        [message]
            speaker=Warlord_West
            message=_ "Queen, queen! Your queen can't do anything without orcs! Why do you listen to that woman, Whitefang? Kill her and join the fun!"
        [/message] 

        [message]
            speaker=Isolde
            message=_ "You make a move, Bazur, and an arrow in your throat will be your final reward."
        [/message] 

        [message]
            speaker=narrator
            image="wesnoth-icon.png"
            message=_ "Isolde loaded the crossbow."
        [/message] 

        [message]
            speaker=Bazur 
            message=_ "..."
        [/message]

        [message]
            speaker=Bazur 
            message=_ "She's got a point. It's better to obey the queen, she'll pay more that way!"
        [/message]

        [message]
            speaker=Warlord_West
            message=_ "What a shame, the Whitefang chief is scared of a human woman! I'm not like you, I'll take what's mine and no one will stop me!"
        [/message]

        [message]
            speaker=Warlord_South
            message=_ "Yeah, me too!"
        [/message] 

        [message]
            speaker=Isolde
            message=_ "It's a good thing you're wiser than those two. General Henri will be here soon, and if we don't drive the marauders out of the town, he'll punish us with them!"
        [/message] 

        [message]
            speaker=Bazur 
            message=_ "Then attack! "
        [/message]

        [modify_side]
            side=4
            team_name=bazur
            user_team_name=_ "Loyalists"
            color=purple
            {FLAG_VARIANT loyalist}
        [/modify_side]
        
        [modify_side]
            side=2,3
            team_name=evil_orcs
            user_team_name=_ "Marauders"
        [/modify_side]

        [modify_turns]
            add=10
        [/modify_turns]

        [show_objectives][/show_objectives]

        [event]
            name=die,moveto
            first_time_only=no 

            [filter]
                side=2,3
            [/filter]

            [if]
                [have_unit]
                    side=2,3
                    [filter_location]
                        x,y=21,16
                        radius=4
                    [/filter_location]
                [/have_unit]

                [then]
                [/then]

                [else]
                    [endlevel]
                        result=victory 
                    [/endlevel]
                [/else]
            [/if]
        [/event]
    [/event]

    [event]
    name=victory

        [modify_side]
            side=2,3
            team_name=bazur
        [/modify_side]

        [modify_side]
            side=4
            color=silver
        [/modify_side]

        [message]
            side=2,3
             message=_ "All right, no robbery, no robbery, we get it! Stop it!"
        [/message]

        [message]
            speaker=Isolde
            message=_ "Exactly."
        [/message] 

        [scroll_to]
            x,y=21,16 
        [/scroll_to]

        [hide_unit]
            side=1,2,3,4,5,6,7
        [/hide_unit]

        {FADE_TO_BLACK}

        [kill]
            side=2,3,4,5,6,7
            canrecruit=no 
        [/kill]

        [put_to_recall_list]
            side=1
            canrecruit=no 
            [not]
                id=Isolde 
            [/not]
        [/put_to_recall_list]

        {TELEPORT_UNIT id=Warlord_South 18 16}
        {TELEPORT_UNIT id=Warlord_West 18 14}
        {TELEPORT_UNIT id=Bazur 18 15}

        [modify_unit]
            [filter]
                race=orc 
                canrecruit=yes 
            [/filter]
            facing=se
        [/modify_unit]

        {TELEPORT_UNIT id=Isolde 20 15}

        {FULL_HEAL id=Warlord_South}
        {FULL_HEAL id=Warlord_West}
        {FULL_HEAL id=Bazur}
        {FULL_HEAL id=Isolde}

        [print]
            text=_ "Soon General Henri arrived at Tath..."
            size=50
            duration=1000
            color=255,255,255
        [/print]

        [delay]
            time=1000
        [/delay]

        {FADE_IN}

        [unhide_unit]
            side=1,2,3,4
        [/unhide_unit]

        {UNIT 4 General 21 16 (id=General 
        {HENRI}
        canrecruit=yes
        facing=sw)}
        {UNIT 4 Halberdier 19 17 (facing=sw)}
        {UNIT 4 Halberdier 19 15 (facing=sw)}

        [message]
            speaker=General
            message=_ "What happened here, why are the city streets drowning in blood?"
        [/message] 

        [message]
            speaker=Warlord_South
            message=_ "Whitefang was late to the assault, and because of him, the victory was given to us with great blood!"
        [/message]

        [message]
            speaker=General
            message=_ "Silence, orc, I'm not talking to you!"
        [/message] 

        [message]
            speaker=Isolde
            message=_ "General, we arrived just in time to take the city in a blitz, but the orcs from the other units wanted to loot it and massacred it. They were only stopped after we knocked them out of the walls."
        [/message] 

        [message]
            speaker=General
            message=_ "Which of these three are from your squad?"
        [/message] 

        [message]
            speaker=Isolde
            message=_ "(pointing at Bazur) He is, General."
        [/message] 

        [message]
            speaker=General
            message=_ "Guards, let him stay, and execute the rest on the spot!"
        [/message] 

        [message]
            speaker=Warlord_South
            message=_ "Whoa, whoa, whoa, chief, stop-"
        [/message] 

        [animate_unit]
        flag=attack
            [filter]
                x,y=19,17
            [/filter]
            [facing]
                x,y=18,16
            [/facing]
            [primary_attack]                    
                range=melee
                type=blade
            [/primary_attack]
            hits=yes
            [animate]
                flag=defend
                    [filter]
                        x,y=18,16
                    [/filter]
                    hits=yes
                [/animate]
            [/animate_unit]

            [kill]
                id=Warlord_South
                animate=yes
            [/kill]

            {PLACE_IMAGE "units/orcs/grunt-die-8.png~RC(magenta>blue)~FL(horiz)" 18 16}

            [animate_unit]
            flag=attack
                [filter]
                    x,y=19,15
                [/filter]
                [facing]
                    x,y=18,14
                [/facing]
                [primary_attack]
                    range=melee
                    type=blade
                [/primary_attack]
                hits=yes
                [animate]
                    flag=defend
                    [filter]
                        x,y=18,14
                    [/filter]
                    hits=yes
                [/animate]
            [/animate_unit]

            [kill]
                id=Warlord_West
                animate=yes
            [/kill]

            {PLACE_IMAGE "units/orcs/grunt-die-8.png~RC(magenta>green)" 18 14}

            [delay]
                time=400
            [/delay]

            [message]
                speaker=General
                message=_ "Mark my words, orc! You have been recruited into the <i>Royal Army</i>. What separates the <i>Royal Army</i> from the orcish horde is <i>iron discipline</i>. <i>Discipline</i> means obeying orders <i>exactly</i> as commanded. You kill only those you're ordered to kill. If you disobey orders, you'll share the fate of these marauders. Do I make myself clear?"
            [/message] 

            [message]
                speaker=Bazur
                message=_ "I got it, chief!"
            [/message] 

            [message]
                speaker=General
                message=_ "Chiefs in your wastelands and generals in Wesnoth. Mark it."
            [/message] 

            [message]
                speaker=General
                message=_ "I got your dispatch, Isolde. Tell me more about what happened in the Glyn's Forest."
            [/message]

            [message]
                speaker=narrator
                image=wesnoth-icon.png 
                message=_ "Isolde reported her raid to the general."
            [/message] 

            [message]
                speaker=General
                message=_ "So the witch did ruin Gwido after all. That's unfortunate. Did you kill her?"
            [/message]

            [message]
                speaker=Isolde
                message=_ "No, general, we only defeated the rebels."
            [/message] 

            [message]
                speaker=General
                message=_ "And rightly so. All the elvish lords have their eyes on our war right now. We can't give them a reason to interfere. We've had enough of orcs. Although I don't think elves belong in a forest named after the King Founder's son."
            [/message]

            [message]
                speaker=Isolde
                message=_ "I agree. How's the war going, general? Any news from the south? "
            [/message]

            [message]
                speaker=General
                message=_ "The queen has defeated de Ferres' army at Weldyn and has moved her army on Dan-Tonk. I have orders to lay siege to the city from the north. I also have special orders for orcs loyal to the crown, if there are any."
            [/message] 

            [message]
                speaker=Bazur
                message=_ "I'm loyal to the crown, loyal as can be!"
            [/message] 

            [message]
                speaker=Isolde
                message=_ "I think my orcs will do just fine. What are the orders?"
            [/message]

            [message]
                speaker=General
                message=_ "Dan-Tonk is a great fortress. Even after all his defeats, de Ferres has hundreds of soldiers at hand. A straight assault would cost us dearly. However, there is a secret tunnel between Tath and Dan-Tonk that leads to the catacombs, and from them to the heart of the city. The queen wants the orcs to sneak through the tunnel and open the gates of Dan-Tonk from the inside just before the assault."
            [/message] 

            [message]
                speaker=Bazur
                message=_ "I can do it! Tunnels are no problem for me, and I can knock out gates in a heartbeat! "
            [/message]

            [message]
                speaker=Isolde
                message=_ "I'll take that mission, general."
            [/message] 

            [message]
                speaker=General
                message=_ "You mustn't go with the orcs, Isolde. Stay in my army, I'll give you a squad of swordsmen instead of these brutes."
            [/message]

            [message]
                speaker=Isolde
                message=_ "The queen said these orcs would be my soldiers. A commander shouldn't abandon his soldiers, should he, general?"
            [/message] 

            [message]
                speaker=General
                message=_ "You sound just like your husband. That's why I don't want to send you. There's little chance of survival in the middle of a siege, and Wesnoth needs people like you."
            [/message]

            [message]
                speaker=Isolde
                message=_ "I would disgrace my husband's honor if I abandoned my soldiers."
            [/message] 

            [message]
                speaker=General
                message=_ "Then I won't discourage you. Go, and may all the gods protect you, if they still care about our country."
            [/message]

            [message]
                speaker=Bazur
                message=_ "Wait, chie-, general, what about the reward?"
            [/message]

            [message]
                speaker=General
                message=_ "Ah, yes. The queen sent a sword as a reward for <i>her loyal dog</i>. That would be you. Wear it proudly, your paws have never held such a masterful weapon, nor will they ever!"
            [/message]

            [object]
                [filter]
                    is=Bazur 
                [/filter]

                duration=forewer 
                name= _ "Wesnothian Great Sword"
                image="attacks/greatsword-human.png"
                description= _ "The honed blade from the Royal Armory replaces Bazur's sword, and increases melee damage by 3!"

                [effect]
                    apply_to=attack 
                    range=melee 
                    increase_damage=3 
                    set_icon="attacks/greatsword-human.png"
                    set_description=_ "wesnothian greatsword"
                [/effect]
            [/object]

            [message]
                speaker=Bazur
                message=_ "So big and sharp! I'm proud, I'm so proud!"
            [/message]

            [message]
                speaker=General
                message=_ "Now go. The assault will begin in two weeks, you'll know it by the terrible rumble from the surface. As soon as the rumbling dies down, go in. And try to survive, Isolde."
            [/message]

            [message]
                speaker=Isolde
                message=_ "Yes, general!"
            [/message] 
    [/event]  

    [event]
    name=last_breath 

        [filter]
            side=2,3
            canrecruit=yes 
        [/filter]

        [modify_unit]
            [filter]
                id=$second_unit.id
            [/filter]
            experience="$($second_unit.experience + 24)"
        [/modify_unit]

        [modify_unit]
            [filter]
                find_in=unit 
            [/filter]
            hitpoints=1
        [/modify_unit]

        [endlevel]
            result=victory 
        [/endlevel]
    [/event]

    [event]
    name=time over 

        [message]
            speaker=Isolde
            message=_ "We didn't get Tath in time and foiled the Queen's plan. General Henri will be here soon, and he will be furious."
        [/message]

        [message]
            speaker=Bazur
            message=_ "Argh, weep for my awards!"
        [/message]
    [/event]

    #Cowarldy Peasants-related events:
    #Isolde won't attack them:

    [event]
        name=attack 
        first_time_only=no 

        [filter]
            id=Isolde
        [/filter]
        [filter_second]
            role=coward 
        [/filter_second]

        [message]
            speaker=Isolde 
            message=_ "I won't kill unarmed peasants."
        [/message]

        [cancel_action][/cancel_action]

        [modify_unit]
            [filter]
                id=Isolde 
            [/filter]
            attacks_left=1 
        [/modify_unit]
    [/event]

    #But Bazur id gladly to do it:

    [event]
        name=attack  
        id=orcish_attack_event

        [filter]
            side=1 
            [not]
                race=human 
            [/not]
        [/filter]
        [filter_second]
            role=coward 
        [/filter_second]

        [message]
            speaker=second_unit
            message=_ "A-a-a, it's not ours, more orcs are coming out of the woods!"
        [/message]

        [message]
            speaker=unit
            message=_ "Fight, you human goblin!"
        [/message]
        [remove_event]
            id=human_attack_event 
        [/remove_event]
    [/event]

    [event]
        name=attack
        id=human_attack_event  

        [filter]
            side=1 
            race=human 
            [not]
                id=Isolde 
            [/not]
        [/filter]
        [filter_second]
            role=coward 
        [/filter_second]

        [message]
            speaker=second_unit
            message=_ "A-a-a, it's not ours, royal punishers are coming out of the woods!"
        [/message]

        [message]
            speaker=unit
            message=_ "Bow to the queen, or die!"
        [/message]
        [remove_event]
            id=orcish_attack_event
        [/remove_event]
    [/event]

    [event]
        name=attack

        [filter]
            race=elf
        [/filter]
        [filter_second]
            role=coward 
        [/filter_second]

        [message]
            speaker=second_unit
            message=_ "Elves, help us!"
        [/message]

        [message]
            speaker=unit
            message=_ "You have failed the Lady and won't fight for your freedom. You are not worthy of the elves' help, death is the best outcome for you!"
        [/message]

        [set_achievement]
            content_for=AD_Achievements
            id=AD_S05_Elves
        [/set_achievement]
    [/event]

    #They are hidding in the forest

#   [event]
#   name=moveto 
#
#        [filter]
#            role=coward 
#        [/filter]
#
#        [message]
#            speaker=unit 
#            message=_ "Run to the woods, to ours!"
#        [/message]
#    [/event]

    [event]
    name=moveto 
    first_time_only=no 

        [filter]
            role=coward
            [filter_location]
                x,y=38,1
                radius=1
            [/filter_location]
        [/filter]

        [kill]
            find_in=unit 
            animate=no 
        [/kill]
    [/event]

    #Big Kruuk smash the peasants

    [event]
    name=attack 
    first_time_only=yes 

        [filter]
            id=Big_Kruuk
        [/filter]

        [filter_second]
            type=Peasant
        [/filter_second]

        [message]
            speaker=unit
            message=_ "Run, bug, run!"
        [/message] 
    [/event]

    [event]
    name=die 

        [filter]
            type=Peasant
        [/filter]

        [filter_second]
            id=Big_Kruuk
        [/filter_second]

        [message]
            speaker=Big_Kruuk
            message=_ "Didn't run away! Ha-ha-ha!"
        [/message] 
    [/event]

    #Events #2: Vengeful elf appears

    [event]
        name=turn 3

        {UNIT 5 "Elvish Avenger" 37 1 (animate=yes 
        id=Vengeful_Elf 
        name=_ "Vengeful Elf"
        [modifications]
            {TRAIT_STRONG}
            {TRAIT_DEXTROUS}
            #effect
        [/modifications])}

        {IF_VAR lady_aviel_defeated equals yes (
        [then]
            [message]
                speaker=Vengeful_Elf 
                message=_ "Villains, you will pay a terrible price for injuring Lady Aviel and banishing her from her own home!"
            [/message]
            [message]
                speaker=Bazur
                message=_ "You didn't get enough of the fight? All right, come here, I won't spare you, I promise you that!"
            [/message]
        [/then]
        [else]
            [message]
                speaker=Vengeful_Elf 
                message=_ "Lady Aviel has sent you retribution in my person. Prepare to die, villains!"
            [/message]
            [message]
                speaker=Bazur
                message=_ "Come here, I'll show you what would happen to your damned lady if I got my hands on her!"
            [/message]
        [/else])}
    [/event]

    [event]
        name=die 

        [filter]
            id=Vengeful_Elf 
        [/filter]

        {IF_VAR lady_aviel_defeated equals yes (
        [then]
            [message]
                speaker=Bazur
                message=_ "I told you we should kill her! Now you'll have vigilantes like this chasing you for the rest of your life."
            [/message]

            [message]
                speaker=Isolde
                message=_ "So that's what elven gratitude is like."
            [/message]
        [/then]
        [else]
            [message]
                speaker=Bazur
                message=_ "Looks like the witch is serious about war!"
            [/message]

            [message]
                speaker=Isolde
                message=_ "Then I don't envy her. General Henry is tough, and so are his men. They won't let her get away with it."
            [/message]

            [message]
                speaker=Bazur
                message=_ "Ho-ho! I wish I could see her get punished!"
            [/message]
        [/else])}
    [/event]

    #Goblins Event: 

    [event]
    name=moveto
    first_time_only=yes

            [filter]
                side=1
                [filter_location]
                    [filter]
                        side=6
                    [/filter]
                    radius=1
                [/filter_location]
            [/filter]

            [message]
                speaker=Bazur
                message=_ "Hey, goblins, why are you sitting here?"
            [/message]

            [message]
                speaker=Punk
                message=_ "We hear humans are taking orcs into their service, and they pay well! They told us to go to Soradoc and they'd hire you there. But where is Soradoc? We got lost. We went to a town to the south, and we were met with arrows, and we barely got away! Punk thinks it's all lies about the service."
            [/message]

            [message]
                speaker=Bazur
                message=_ "You're wrong, it's all true, I'm already in royal service!"
            [/message]

            [message]
                speaker=Punk
                message=_ "Uh-huh! Does it pay well?"
            [/message]

            [message]
                speaker=Bazur
                [option]
                    message= _ "Yeah! Join me, and you'll get some too!"
                    [command]
                        [message]
                            speaker=Punk
                            message=_ "Punk's no fool, he won't fight for nothing. Give 100 gold coins, and Punk is yours!"
                        [/message]

                        [store_gold]
                            variable=bazurgold
                            side=1
                        [/store_gold]

                        [message]
                            speaker=Bazur
                            [option]
                                [show_if]
                                    {VARIABLE_CONDITIONAL bazurgold greater_than_equal_to 100}
                                [/show_if]
                                message=_ "All right, here's your gold, now get to work! (-100 gold)"
                                [command]

                                    [sound]
                                        name=gold.ogg
                                    [/sound]
                        
                                    [gold]
                                        amount=-100
                                        side=1
                                    [/gold]

                                    [modify_side]
                                        side=6
                                        team_name=bazur 
                                    [/modify_side]

                                    {MODIFY_AI_DELETE_ASPECT 6 avoid stay_in_camp}

                                    [message]
                                        speaker=Punk 
                                        message=_ "Punk will tear your enemies apart!"
                                    [/message]
                                [/command]
                            [/option]
                            [option]
                                [show_if]
                                    {VARIABLE_CONDITIONAL bazurgold less_than 100}
                                [/show_if]
                                message=_ "I don't have 100 gold right now."
                                [command]
                                    [message]
                                        speaker=Punk 
                                        message=_ "Then stay away from Punk, you liar!"
                                    [/message]
                                [/command]
                            [/option]
                            [option]
                                message=_ "Greedy goblin! Either you're with me or I'll rip your head off, take your pick!"
                                [command]
                                    [message]
                                        speaker=Punk 
                                        message=_ "Why do you have to yell? All right, all right, Punk will go with you, just make the humans accept us!"
                                    [/message]

                                    [modify_side]
                                        side=6
                                        team_name=bazur 
                                    [/modify_side]

                                    {MODIFY_AI_DELETE_ASPECT 6 avoid stay_in_camp}
                                [/command]
                            [/option]
                        [/message]   
                    [/command]
                [/option]
                [option]
                    message= _ "Yeah! But you'll never get a coin, you little bastard! Go away, I don't want any competitors!"
                    [command]
                        [message]
                            speaker=Punk 
                            message=_ "Punk will take the gold off your corpse!"
                        [/message]

                        [modify_side]
                            side=6
                            team_name=evil_orcs
                        [/modify_side]

                        {MODIFY_AI_DELETE_ASPECT 6 avoid stay_in_camp}
                    [/command]
                [/option]
            [/message]
    [/event]

    #de Ferre's reinforcements 
    [event]
        name=turn 6

        [scroll_to]
            x,y=7,31
        [/scroll_to]

        [sound]
            name=horse-canter.wav 
        [/sound]

        [move_unit_fake]
            type=Сavalier
            side=7
            x=7,8,9,9,10,10,11
            y=31,30,30,29,28,27,27
        [/move_unit_fake]

        {GENERIC_UNIT 7 Cavalier 11 27}

        [move_unit_fake]
            type=Cavalier
            side=7
            x=7,8,9,9,10,10,11
            y=31,30,30,29,28,27,28
        [/move_unit_fake]

        {GENERIC_UNIT 7 Cavalier 11 28}

        [move_unit_fake]
            type=Cavalier
            side=7
            x=7,8,9,9,10,10,10
            y=31,30,30,29,28,27,26
        [/move_unit_fake]

        {GENERIC_UNIT 7 Cavalier 10 26}

        [move_unit_fake]
            type=Cavalier
            side=7
            x=7,8,9,9,10,10
            y=31,30,30,29,28,27
        [/move_unit_fake]

        {GENERIC_UNIT 7 Cavalier 10 27}

        [if]
            [have_unit]
                id=Sir_Gwido 
            [/have_unit]
        [then]

        [message]
            side=7 
            type=Cavalier 
            message=_ "Baron de Ferres sent us to help Tath."
        [/message]

        [message]
            speaker=Sir_Gwido
            message=_ "Good to see you riders! We're in a dangerous position, hurry up and break through the orc encirclement!"
        [/message]

        [message]
            side=7 
            type=Cavalier 
            message=_ "We'll cut our way through. "
        [/message]
        [/then]

        [else]
            [message]
                side=7 
                type=Cavalier 
                message=_ "The city had fallen, but the cavaliers would not run away from the battlefield! Let's go to the final battle and show the orcs what de Ferres' men are like!"
            [/message]
        [/else]
    [/if]
    [/event]

    [event]
        name=attack 

        [filter]
            id=Aryn 
        [/filter]

        [filter_second]
            type=Cavalier 
        [/filter_second]

        [message]
            speaker=second_unit
            message=_ "A regret to see a worthy cavalryman in the enemy's ranks! A stroke of the sword will eliminate this sight!"
        [/message]

        [message]
            speaker=Aryn
            message=_ "I can say the same thing! Defend yourself, sir!"
        [/message]
    [/event]

    [event]
        name=last breath

        [filter]
            type=Cavalier
        [/filter]

        [filter_second]
            id=Aryn
        [/filter_second]

        [message]
            speaker=unit
            message=_ "I rejoice that I have died at the hand of a knight!"
        [/message]

        [message]
            speaker=Aryn
            message=_ "Farewell, sir, may the songs of your valor never fade!"
        [/message]
    [/event]
[/scenario]
