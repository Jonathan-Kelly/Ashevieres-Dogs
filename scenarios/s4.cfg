#textdomain wesnoth-AD

[scenario]
    id=AD_04
    name= _ "The Raid"
    map_data="{~add-ons/Ashievieres_Dogs/maps/AD_04.map}"
    {TURNS 26 22 19}
    next_scenario=AD_05
    victory_when_enemies_defeated=no
    carryover_percentage=40
    carryover_add=yes
    current_time=2

    {DEFAULT_SCHEDULE}

    {SCENARIO_MUSIC "breaking_the_chains.ogg"}
    {EXTRA_SCENARIO_MUSIC "frantic.ogg"}
    {EXTRA_SCENARIO_MUSIC "battle.ogg"}
    {EXTRA_SCENARIO_MUSIC "casualties_of_war.ogg"}

    [story]
        [part]
            story=_"Пока шайка Базура гонялась за тяжёлой пехотой, в Веснот прибывало всё больше орков. Все они проходили через Сорадок - за что город стали иронично назвать Сорадорк и отправлялись в Велдин, где присягале королеве на верность."
            {AD_BIGMAP}
            {JOURNEY_03_OLD}
        [/part]
        [part]
            story=_"Ашевир прекрасно понимала, что призывает бурю; она видела, что верность орков подчас измеряется в золоте, что вожди нередко нападают друг на друга и на королевскую армию, либо чрезмерно увлекаются мародёрством. Но королеве были нужны солдаты, и она сочла пару десятков разграбленных сёл справедливой платой за будущие годы мира и процветания."
            {AD_BIGMAP}
            {JOURNEY_03_OLD}
        [/part]
        [part]
            story=_"Для бунтовщиков же прибытие орков стало полной неожиданностью. Они не верили, что Ашевир решится на столь вероломный шаг. Их шансы на победу таяли с каждой новоприбывшей орочьей шайкой. В тоже время западные провинции, и, в частности, Элесенфар, как будто не осознавали весь ужас происходящего, и не торопились присылать подмогу."
            {AD_BIGMAP}
            {JOURNEY_03_OLD}
        [/part]
        [part]
            story=_"Пока Базур и Изольда пробирались в Глинов лес, из Дан-Тонка стартовал запоздалый марш на Велдин."
            {AD_BIGMAP}
            {JOURNEY_03_OLD}
        [/part]
        [part]
            story=_"Углубивись на несколько вёрст в лес, герои обнаружили, что худшие опасения Изольды потдвердились."
            {AD_BIGMAP}
            {JOURNEY_03_OLD}
        [/part]
    [/story]

    {AD_TRACK {JOURNEY_04_NEW} }

    [time_area]
        {LIGHT_SCHEDULE 2}
        id=campfire
        x=38,25,33,23,10,6,12,20,33
        y=3,6,11,13,12,17,19,23,29
    [/time_area]


    #player average recruit cost = 17,6

    #define STORAGE X Y SIDE

    {PLACE_IMAGE items/box.png {X} {Y}}

    [label]
        x,y={X},{Y}
        text=_ "Склад стороны {SIDE}"
        immutable=yes
    [/label]

    [event]
    name=prestart

        [terrain]
            x={X}
            y={Y}
            terrain=Ce^Xo
        [/terrain]
    [/event]

    [event]
    name=moveto
    first_time_only=yes

        [filter]
            side=1
            type="Orcish Archer","Orcish Crossbowman","Orcish Slurbow","Goblin Pillager"
            [filter_location]
                x,y={X},{Y}
                radius=1
            [/filter_location]
        [/filter]

        [message]
            speaker=unit 
            message=_ "Сжигаю склад!"
        [/message]

        [animate_unit]
            flag=attack
            [filter]
                find_in=unit
            [/filter]
            [facing]
                x,y={X},{Y}
            [/facing]
            [primary_attack]
                type=fire
            [/primary_attack]
            hits=yes
        [/animate_unit]

        [sound_source]
            id=burned_{X}_{Y}
            loop=-1
            x,y={X},{Y}
            sounds=ambient/campfire.ogg
            full_range=5
            fade_range=3
        [/sound_source]

        [item]
            halo="scenery/flames[01~15].png"
            image="scenery/flames01.png"
            visible_in_fog=yes
            x={X}
            y={Y}
        [/item]

        [time_area]
            {INDOORS}
            id=fire{X}_{Y}
            x={X}
            y={Y}
        [/time_area]

        [gold]
            side={SIDE}
            amount=-40
        [/gold]

        {REMOVE_LABEL {X} {Y}}

        [redraw] [/redraw]

        {VARIABLE_OP burned_storages add 1}

        [if]
            [variable]
                name=burned_storages
                numerical_equals=6
            [/variable]
        [then]
            [if]
                [have_unit]
                    side=2,3,4
                    canrecruit=yes 
                [/have_unit]
            [then]
                [message]
                    speaker=Isolde
                    message= _ "Склады бунтовщиков уничтожены. Осталось перебить их лидеров."
                [/message]
            [/then]
            [else]
                [endlevel]
                    result=victory 
                [/endlevel]
            [/else]
            [/if]
        [/then]
        [else]
        [/else]
        [/if]
    [/event]
#enddef

    {STARTING_VILLAGES_ALL 4}
    {STARTING_VILLAGES 5 30}
    {STARTING_VILLAGES_AREA 5 7 5 8}
    {STARTING_VILLAGES 1 3}
    {STARTING_VILLAGES 2 5}
    {STARTING_VILLAGES 3 5}
    {STARTING_VILLAGES_AREA 3 18 24 8}
    {STARTING_VILLAGES 4 5}

    {AD_CAPTURE_EVENT 4}
    {AD_MARAUDERS}
    {HERODEATH_ACT_I}

    [side]
        side=1
        controller=human
        {GOLD 145 120 100}
        income=0
        fog=no
        shroud=no
        share_vision=all
        {BAZUR_ARC_I}
        recruit=Orcish Grunt,Orcish Archer,Wolf Rider,Goblin Spearman,Orcish Assassin
        color=red
        team_name=bazur
        user_team_name= _ "Bazur's clan"
        {FLAG_VARIANT ragged}
    [/side]

    [side]
        side=2
        controller=ai
        type=Sergeant
        id=Rebel_Sergeant
        name=_ "Sergeant"
        canrecruit=yes
        recruit=Ruffian,Woodsman
        {GOLD 25 35 50}
        {INCOME 2 3 6}
        fog=no
        shroud=no
        share_vision=all
        color=blue
        team_name=rebels
        user_team_name= _ "Wesnoth Rebels"
        {FLAG_VARIANT long}
    [/side]

    [side]
        side=3
        controller=ai
        type=Rogue
        id=Rebel_Rogue
        name=_ "Roga"
        canrecruit=yes
        recruit=Thief,Poacher,Ruffian,Thug,Footpad
        {GOLD 25 35 50}
        {INCOME 2 3 6}
        fog=no
        shroud=no
        share_vision=all
        color=green
        team_name=rebels
        user_team_name= _ "Wesnoth Rebels"
        {FLAG_VARIANT long}

        [ai]
            grouping=defensive
        [/ai]
    [/side]

    [side]
        side=4
        controller=ai
        type=Huntsman
        id=Rebel_Huntsman
        name=_ "Huntsman"
        canrecruit=yes
        recruit=Thief,Poacher,Ruffian,Thug,Footpad,Outlaw,Bandit,Trapper
        {GOLD 25 35 50}
        {INCOME 2 3 6}
        fog=no
        shroud=no
        share_vision=all
        color=black
        team_name=rebels
        user_team_name= _ "Wesnoth Rebels"
        {FLAG_VARIANT long}

        [ai]
            grouping=defensive
        [/ai]
    [/side]

    {LIMIT_CONTEMPORANEOUS_RECRUITS 5 "Elvish Captain" 2}

    [side]
        side=5
        controller=ai
        type=Elvish Champion
        id=Elf_Lord
        name=_ "Elf Lord"
        canrecruit=yes
        recruit=Elvish Fighter,Elvish Archer,Elvish Shaman,Elvish Captain
        {GOLD 45 55 70}
        village_gold=3
        fog=no
        shroud=no
        share_vision=all
        hidden=no
        color=brown
        team_name=rebels
        user_team_name= _ "Wesnoth Rebels"
        {FLAG_VARIANT wood-elvish}

        [ai]
            aggression=0.3
            caution=0.7
            grouping=offensive
        [/ai]
    [/side]

    [event]
    name=prestart 

        #ifdef HARD
            [allow_recruit]
                side=5
                type=Elvish Ranger 
            [/allow_recruit]
        #endif

        [recall]
            id=Isolde
            side=1
        [/recall]

        [micro_ai]
            side=5
            ai_type=healer_support
            action=add

            [filter]
                type=Elvish Captain 
            [/filter]
            [filter_second]
                side=5
                level=1
            [/filter_second]
            aggression=0.6
        [/micro_ai]
    [/event]
    
    [event]
    name=start 

        [message]
            speaker=Isolde 
            message=_ "Так я и думала. Бунтовщики устроили здесь целый лагерь!"
        [/message]

        [scroll_to_unit]
            side=2
            canrecruit=yes 
        [/scroll_to_unit]

        [delay]
            time=500
        [/delay]

        [scroll_to_unit]
            side=4
            canrecruit=yes 
        [/scroll_to_unit]

        [delay]
            time=500
        [/delay]

        [message]
            side=3
            canrecruit=yes
            message=_ "Караул, королевские шавки в лесу!"
        [/message]

        [message]
            speaker=Elf_Lord
            message=_ "Спокойно, я всё улажу. По какому праву Вы, солдаты Ашевир, вторгаетесь в суверенную территорию эльфов Глинова леса? Согласно договору между нашими землями, войскам Веснота воспрещается пересекать границу без моей санкции."
        [/message]

        [message]
            speaker=Bazur
            message=_ "Что он там мелет! Эй, да я тебя..!"
        [/message]

        [message]
            speaker=Isolde 
            message=_ "Замолчи, болван. Вы зря упомянули договор, лорд эльфов, ведь согласно нему же, обе стороны обязуются не укрывать разыскиваемых преступников."
        [/message]

        [message]
            speaker=Elf_Lord
            message=_ "И что? Ашевир, вот, кто настоящая преступница, узурпатор трона, тиран."
        [/message]

        [message]
            speaker=Isolde 
            message=_ "Пф, опять мудрые эльфы решают, кто в Весноте хороший, а кто плохой."
        [/message]

        [message]
            speaker=Elf_Lord
            message=_ "Ты рассуждаешь о добре и зле, имея за спиной отряд орков-головорезов, смешная девчонка."
        [/message]

        [message]
            speaker=Isolde 
            message=_ "А называешь Ашевир, укрывая нарушителей закона, воров, убийц и изменников. Как по мне, эльфы просто завидуют, что королева обратилась к оркам, а не к вам."
        [/message]

        [message]
            speaker=Bazur
            message=_ "Конечно, эльфы-то только языком чесать умеют, из своих посыпанных навозом лесов!"
        [/message]

        [message]
            speaker=Elf_Lord
            message=_ "Довольно! Покиньте Глинов лес, или ваши действия будут расценены, как объявление войны!"
        [/message]

        [message]
            speaker=Isolde 
            message=_ "Ты уже воюешь с короной руками бунтовщиков, подлец. Пора тебе иметь мужество и встретиться с её солдатами лицом к лицу."
        [/message]

        [message]
            sound=horn-signals/horn-7
            speaker=Elf_Lord
            message=_ "Ты поплатишься за свою дерзость. Поднимайтесь, солдаты! Защитим свободных людей от псов тирании."
        [/message]

        [message]
            sound=ambient/wardrums.ogg
            speaker=Bazur
            message=_ "Давай-давай! Я соскучился по вашей жиденькой эльфийской крови."
        [/message]

        [message]
            speaker=Isolde 
            message=_ "Не увлекайся эльфами слишком сильно. Наша цель - уничтожить лидеров бунтовщиков и сжечь их склады."
        [/message]

        [objectives]
            silent=no
                [objective]
                    [show_if]
                        [variable]
                            name=burned_storages
                            less_than=6
                        [/variable]
                    [/show_if]
                    description= _ "Сожгите все склады бунтовщиков"
                    condition=win
                [/objective]
                [objective]
                    [show_if]
                        [have_unit]
                            side=2,3,4
                            canrecruit=yes
                        [/have_unit]
                    [/show_if]
                    description= _ "Перебейте всех лидеров бунтовщиков"
                    condition=win
                [/objective]
                [objective]
                    description= _ "Смерть Базура"
                    condition=lose
                [/objective]
                [objective]
                    description= _ "Смерть Изольды"
                    condition=lose
                [/objective]
                {TURNS_RUN_OUT}
                [gold_carryover]
                    bonus=yes
                    carryover_percentage=40
                    carryover_add=yes
                [/gold_carryover]
        [/objectives]   
    [/event]

    [event]
    name=die 
    first_time_only=no

        [filter]
            side=2,3,4
            canrecruit=yes 
        [/filter]

        [if]
            [have_unit]
                side=2,3,4
                canrecruit=yes 
            [/have_unit]
        [then]
        [/then]

        [else]
            [if]
                [variable]
                    name=burned_storages
                    less_than=6 
                [/variable]
            [then]
                [message]
                    speaker=Isolde 
                    message=_ "Лидеры бунтовщиков перебиты. Сжигаем их склады и уходим отсюда."
                [/message]
            [/then]
            [else]
                [endlevel]
                    result=victory
                    carryover_add=yes 
                    bonus=yes
                [/endlevel]
            [/else]
            [/if]
        [/else]
        [/if]
    [/event]

    [event]
    name=victory

        [message]
            speaker=Isolde 
            message=_ "Мы сделали, что хотели. Пора возвращаться к основному заданию."
        [/message]

        [message]
            speaker=Elf_Lord
            message=_ "Это вторжение вам дорого обойдётся. Эльфы всех лесов выступят против вашей злой королевы, и тогда..."
        [/message]

        [message]
            speaker=Bazur
            message=_ "Да-да, как закончишь голосить, пришли ещё эльфов, я вашего брата хоть целый день резать готов!"
        [/message]
    [/event]

    [event]
    name=time over 

        [message]
            speaker=Isolde
            message=_ "Плохая была идея соваться в этот лес. По плану мы уже должы были присоединиться к осаде Тафа, а мы всё ещё торчим здесь и не можем справиться с бунтовщиками!"
        [/message]

        [message]
            speaker=Bazur
            message=_ "Ар, плакали мои награды!"
        [/message]
    [/event]

    {STORAGE 35 30 2}
    {STORAGE 27 24 3}
    {STORAGE 20 27 3}
    {STORAGE 15 19 4}
    {STORAGE 9 26 4}
    {STORAGE 3 17 4}
    
[/scenario]
